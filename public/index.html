<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Digital Twin Lab</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background-color: #f8f9fa;
      color: #333;
      line-height: 1.6;
    }
    
    .app-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 30px;
    }
    
    header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    h1 {
      color: #2c3e50;
      margin-bottom: 10px;
      font-weight: 600;
    }
    
    .tagline {
      color: #7f8c8d;
      font-size: 18px;
    }
    
    .workflow {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    
    .module {
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      padding: 30px;
      margin-bottom: 30px;
      transition: transform 0.3s ease;
    }
    
    .module:hover {
      transform: translateY(-5px);
    }
    
    .module-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .module-icon {
      width: 40px;
      height: 40px;
      background-color: #3498db;
      border-radius: 50%;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      margin-right: 15px;
      font-size: 20px;
    }
    
    .module-title {
      margin: 0;
      color: #2c3e50;
      font-size: 24px;
      font-weight: 600;
    }
    
    .module-description {
      color: #7f8c8d;
      margin-bottom: 25px;
    }
    
    input, textarea, button {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border-radius: 5px;
      border: 1px solid #ddd;
      font-size: 16px;
    }
    
    button {
      background-color: #3498db;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s ease;
    }
    
    button:hover {
      background-color: #2980b9;
    }
    
    button:disabled {
      background-color: #bdc3c7;
      cursor: not-allowed;
    }
    
    .danger-button {
      background-color: #e74c3c;
    }
    
    .danger-button:hover {
      background-color: #c0392b;
    }
    
    .status {
      padding: 15px;
      margin: 15px 0;
      border-radius: 5px;
      font-size: 14px;
    }
    
    .success {
      background-color: #d4edda;
      color: #155724;
      border-left: 4px solid #28a745;
    }
    
    .error {
      background-color: #f8d7da;
      color: #721c24;
      border-left: 4px solid #dc3545;
    }
    
    .loading {
      background-color: #e2f3f5;
      color: #0c5460;
      border-left: 4px solid #17a2b8;
    }
    
    .warning {
      font-size: 14px;
      color: #e74c3c;
      margin-bottom: 15px;
    }
    
    .section-title {
      color: #34495e;
      margin-bottom: 10px;
      font-weight: 600;
      font-size: 18px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .info-button {
      background-color: #ecf0f1;
      color: #7f8c8d;
      border: 1px solid #bdc3c7;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 12px;
      font-weight: bold;
      line-height: 18px;
      text-align: center;
      cursor: pointer;
      padding: 0;
      margin: 0;
      flex-shrink: 0;
    }
    
    .info-button:hover {
      background-color: #bdc3c7;
      color: #2c3e50;
    }
    
    .info-tooltip-text {
      display: none;
      background-color: #f8f9fa;
      border: 1px solid #ced4da;
      border-radius: 5px;
      padding: 10px;
      margin-top: 5px;
      margin-bottom: 10px;
      font-size: 14px;
      color: #495057;
      line-height: 1.4;
      position: relative;
      z-index: 1;
    }
    
    .content-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .content-card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      background-color: #f9f9f9;
      position: relative;
      transition: all 0.2s ease;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    .content-card.selected {
      border-color: #3498db;
      background-color: #eaf2f8;
      box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.3);
    }
    
    .content-preview {
      margin-top: 10px;
      margin-bottom: 10px;
      overflow: hidden;
      border-radius: 4px;
    }
    
    .image-preview {
      width: 100%;
      height: 120px;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f1f1f1;
    }
    
    .image-preview img {
      max-width: 100%;
      max-height: 120px;
      object-fit: contain;
    }
    
    .text-preview {
      max-height: 100px;
      overflow-y: auto;
      padding: 8px;
      background-color: #f1f1f1;
      font-family: monospace;
      font-size: 12px;
      white-space: pre-wrap;
      word-break: break-word;
    }
    
    .content-card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    
    .content-type {
      font-size: 12px;
      background-color: #eee;
      padding: 3px 8px;
      border-radius: 20px;
      color: #666;
    }
    
    .content-type.image {
      background-color: #d6eaf8;
      color: #2980b9;
    }
    
    .content-type.text {
      background-color: #d5f5e3;
      color: #27ae60;
    }
    
    .content-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 5px;
      word-break: break-word;
    }
    
    .content-info {
      font-size: 12px;
      color: #777;
      margin-bottom: 5px;
    }
    
    .content-select {
      width: 18px;
      height: 18px;
      position: absolute;
      top: 13px;
      right: 13px;
    }
    
    .content-select:checked {
      accent-color: #3498db;
    }
    
    .selection-bar {
      position: sticky;
      bottom: 0;
      background-color: white;
      padding: 15px;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      margin-top: 20px;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .selection-info {
      font-weight: 600;
    }
    
    .action-button {
      padding: 8px 15px;
      width: auto;
      margin-bottom: 0;
    }
    
    .json-output {
      background-color: #f8f9fa;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 20px;
      font-family: monospace;
      font-size: 14px;
      white-space: pre-wrap;
      max-height: 400px;
      overflow-y: auto;
      margin-top: 20px;
    }
    
    .copy-button {
      background-color: #6c757d;
      margin-top: 10px;
    }
    
    .copy-button:hover {
      background-color: #5a6268;
    }
    
    .flex-row {
      display: flex;
      gap: 15px;
    }
    
    .flex-col {
      flex: 1;
    }
    
    @media (max-width: 768px) {
      .flex-row {
        flex-direction: column;
      }
      
      .content-grid {
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <header>
      <h1>Digital Twin Lab</h1>
      <p class="tagline">Experiment with AI personalities generated from web content and files</p>
    </header>
    
    <div class="workflow">
       <!-- NEW: Module 0 - User Selection -->
      <div class="module" id="user-selection-module">
        <div class="module-header">
          <div class="module-icon" style="background-color: #6c757d;">👤</div> 
          <h2 class="module-title">Select or Create User Profile</h2>
        </div>
        <p class="module-description">Select an existing user profile to load its data, or create a new one.</p>
        <div class="flex-row" style="align-items: flex-end;">
            <div class="flex-col">
                <label for="user-select">Load Existing User:</label>
                <select id="user-select" style="margin-bottom: 0;">
                    <option value="">-- Select User --</option>
                    <!-- Options populated by JS -->
                </select>
            </div>
             <div class="flex-col">
                 <label for="new-user-id">Or Create New User:</label>
                <input type="text" id="new-user-id" placeholder="Enter new User ID (e.g., ken_v1)" style="margin-bottom: 0;">
            </div>
            <div style="flex-basis: 150px;">
                 <button id="create-user-button" class="action-button" style="width: 100%; margin-bottom: 0;">Create User</button>
            </div>
        </div>
        <div id="user-status" class="status"></div>
        <div style="margin-top: 15px; font-weight: bold;">Current User: <span id="current-user-display" style="color: #3498db;">None Selected</span></div>
      </div>

      <!-- Module 1: Collect Content -->
      <div class="module" id="collect-module">
        <div class="module-header">
          <div class="module-icon">1</div>
          <h2 class="module-title">Collect Content</h2>
        </div>
        <p class="module-description">Gather content by scraping websites or uploading files.</p>
        
        <div class="flex-row">
          <!-- Website Scraping -->
          <div class="flex-col">
            <h3 class="section-title">Website Scraping</h3>
            <input type="text" id="scrape-url" placeholder="Enter website URL (e.g., https://example.com)" style="margin-bottom: 10px;">
            <button id="start-scraping" class="button">Start Scraping</button>
            <div id="scrape-status" class="status"></div>
          </div>
          
          <!-- File Upload -->
          <div class="flex-col">
            <h3 class="section-title">File Upload</h3>
            <input type="file" id="file-input" multiple>
            <button id="upload-button">Upload File(s) to Current User</button>
            <div id="upload-status" class="status"></div>
          </div>
        </div>
      </div>
      
      <!-- Module 2: Manage & Select Assets -->
      <div class="module">
        <div class="module-header">
          <div class="module-icon">2</div>
          <h2 class="module-title">Manage & Select Assets</h2>
        </div>
        <p class="module-description">Review collected assets and choose which ones to use for personality generation.</p>
        
        <!-- Asset Display Area -->
        <div id="asset-display-area">
            <p>Loading assets...</p>
          </div>
          
        <!-- Moved Reset Library Section -->
        <div style="border-top: 1px solid #eee; margin-top: 25px; padding-top: 20px; text-align: right;">
             <p class="warning" style="text-align: left; margin-bottom: 10px;">⚠️ Clearing the library permanently deletes all collected assets and generated personality profiles!</p>
             <button id="clear-library-button" class="action-button danger-button" style="width: auto;">Clear Content Library</button>
             <div id="clear-library-status" class="status" style="text-align: left; margin-top: 10px;"></div> <!-- New status div -->
        </div>
        
        <!-- Bulk Actions & Selection Bar (sticky) -->
        <div class="selection-bar">
          <div>
                <!-- Replaced Select All with specific types -->
                <button id="select-all-text-button" class="action-button">Select All Text</button>
                <button id="select-all-image-button" class="action-button">Select All Images</button>
                <button id="deselect-all-button" class="action-button">Deselect All</button>
                <button id="delete-selected-button" class="action-button danger-button">Delete Selected</button>
          </div>
            <div class="selection-info" id="selection-summary">0 items selected</div>
        </div>
      </div>
      
      <!-- Module 3: Generate Personality -->
      <div class="module" id="generate-module">
        <div class="module-header">
          <div class="module-icon">3</div>
          <h2 class="module-title">Generate Personality</h2>
        </div>
        <p class="module-description">Create an AI personality profile based on the selected assets.</p>
        
        <h3 class="section-title">Personality Generation Prompt</h3>
        <textarea id="personality-prompt" rows="6" placeholder="Loading personality generation prompt..."></textarea>
        <div class="flex-row" style="justify-content: flex-end; gap: 10px; margin-bottom: 20px;">
            <button id="save-prompt-button" class="action-button" style="width: auto;">Save Prompt</button>
            <button id="reset-prompt-button" class="action-button" style="width: auto; background-color: #6c757d;">Reset to Default</button>
        </div>
        <div id="prompt-status" class="status"></div>

        <button id="generate-personality-button" class="action-button" style="width:100%;" disabled>Generate Personality Profile</button>
        <div id="personality-generation-status" class="status"></div>
        
        <h3 class="section-title">Generated Personality JSON</h3>
        <pre id="personality-json-output" class="json-output" style="display: none;"></pre>
        <button id="copy-json-button" class="copy-button" style="display: none;">Copy JSON</button>
      </div>

      <!-- Module 4: Chat with Digital Twin -->
      <div class="module" id="chat-module">
          <div class="module-header">
              <div class="module-icon">4</div>
              <h2 class="module-title">Chat with Digital Twin</h2>
    </div>
          <p class="module-description">Interact with the AI personality you created, adding optional lore and simulation parameters.</p>

          <div id="chat-content-area">
            <h3 class="section-title">Generated Personality JSON (Read-only) 
                <button class="info-button" data-tooltip-target="gen-profile-tooltip">?</button>
            </h3>
             <div id="gen-profile-tooltip" class="info-tooltip-text" style="display: none;">
                 <p><strong>What it is:</strong><br>A structured profile extracted from the user's content, summarizing their inferred Big Five traits, interests, values, beliefs, expertise, communication style, and representative expressions.</p>
                 <p><strong>Why it matters:</strong><br>This JSON serves as the computational substrate of the digital twin — a condensed and interpretable summary of the user's identity. By grounding it in the Big Five trait model (<a href="https://psycnet.apa.org/record/1990-97976-000" target="_blank" rel="noopener noreferrer"> foundational framework</a>), we align with the most widely validated framework in personality psychology. Research confirms LLMs can express and emulate these traits with high consistency when given structured input (<a href="https://arxiv.org/abs/2402.01765" target="_blank" rel="noopener noreferrer">Xu et al., 2024</a>).</p>
                 <p>Including elements like interests, values, and representative statements supports trait expression via language, helping the model consistently anchor its behavior in specific conceptual domains (<a href="https://arxiv.org/abs/2206.07550" target="_blank" rel="noopener noreferrer">Jiang et al., 2023</a>). Together, these dimensions ensure that the simulated persona maintains not just psychological coherence but semantic and stylistic continuity as well.</p>
            </div>
            <pre id="chat-personality-json" class="json-output" style="max-height: 150px; background-color: #e9ecef; margin-bottom: 15px; display: none;"></pre>

            <!-- Personal Background Context -->
            <h3 class="section-title">Personal Background Context 
                <button class="info-button" data-tooltip-target="lore-tooltip">?</button>
            </h3>
            <div id="lore-tooltip" class="info-tooltip-text" style="display: none;">
                 <p><strong>What it is:</strong><br>A narrative snapshot of formative experiences, career milestones, and self-identified worldview, often written or approved by the user.</p>
                 <p><strong>Why it matters:</strong><br>Personality is shaped not just by abstract traits but by lived experience. Including key biographical moments allows the model to integrate autobiographical memory into its reasoning and conversational framing. This supports context-appropriate responses and gives the twin a human-like memory scaffold.</p>
                 <p>Emerging work like the Stanford "Digital Twin" study (<a href="https://hai.stanford.edu/news/ai-agents-simulate-1052-individuals-personalities-impressive-accuracy" target="_blank" rel="noopener noreferrer">Park et al., 2024</a>) found that including interview-style life history significantly boosted simulation accuracy. This section ensures the twin doesn't just sound like the user in abstract, but feels like it has lived their path.</p>
            </div>
            <textarea id="chat-lore-input" rows="5" style="margin-bottom: 15px;" placeholder='{
  "background": "Key biographical context or formative experiences...",
  "key_life_milestones": ["Important accomplishments...", "Pivotal life events..."],
  "defining_decisions": ["Significant choices revealing character..."]
}'></textarea>

            <!-- Interaction Context -->
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: -5px;">
                 <h3 class="section-title">Interaction Context 
                    <button class="info-button" data-tooltip-target="interaction-tooltip">?</button>
                 </h3>
                 <label style="font-size: 0.9em; display: flex; align-items: center; gap: 5px; cursor: pointer;">
                    <input type="checkbox" id="include-interaction-context" style="width: auto; margin: 0;" checked> Include in Prompt
                 </label>
            </div>
            <div id="interaction-tooltip" class="info-tooltip-text" style="display: none;">
                 <p><strong>What it is:</strong><br>Structured metadata about the current conversational setting — where the twin is speaking, to whom, and under what assumptions of familiarity or shared interests.</p>
                 <p><strong>Why it matters:</strong><br>Personality is expressed situationally. This section enables the twin to adapt its tone, formality, and emotional expression based on setting, without losing its core identity.</p>
                 <p>This mirrors real-world context-driven trait variation. Modeling personality expression as a function of interaction context produces more natural, believable LLM behavior (<a href="https://arxiv.org/abs/2402.02510" target="_blank" rel="noopener noreferrer">Hu & Collier, 2024</a>).</p>
            </div>
            <textarea id="chat-params-input" rows="5" style="margin-bottom: 15px;"></textarea>

            <!-- RESTORE: Psychological State -->
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: -5px;">
                 <h3 class="section-title">Current Psychological State 
                    <button class="info-button" data-tooltip-target="psych-state-tooltip">?</button>
                 </h3>
                 <label style="font-size: 0.9em; display: flex; align-items: center; gap: 5px; cursor: pointer;">
                    <input type="checkbox" id="include-psych-state" style="width: auto; margin: 0;" checked> Include in Prompt
                 </label>
            </div>
            <div id="psych-state-tooltip" class="info-tooltip-text" style="display: none;">
                 <p><strong>What it is:</strong><br>Sets the AI's current emotional tone and potential variability, adding nuance beyond stable traits (Simulation Enhancement).</p>
                 <!-- Add relevant links/citations if desired -->
            </div>
            <textarea id="chat-psych-state-input" rows="3" style="margin-bottom: 15px;"></textarea>
            
            <!-- Cognitive Style -->
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: -5px;">
                 <h3 class="section-title">Cognitive Style and Dynamics 
                    <button class="info-button" data-tooltip-target="cog-style-tooltip">?</button>
                 </h3>
                 <label style="font-size: 0.9em; display: flex; align-items: center; gap: 5px; cursor: pointer;">
                    <input type="checkbox" id="include-cog-style" style="width: auto; margin: 0;" checked> Include in Prompt
                 </label>
            </div>
             <div id="cog-style-tooltip" class="info-tooltip-text" style="display: none;">
                <p><strong>What it is:</strong><br>A set of parameters describing how the twin thinks, reacts, and varies — including preferred thinking styles (e.g. abstract, systems-level), pacing, and acceptable variability from core traits.</p>
                <p><strong>Why it matters:</strong><br>This layer introduces dynamic flexibility into the simulation. Including things like "response tempo" or "trait_variability_percent" enables more emotionally resonant and believable interactions.</p>
                 <p>Research shows that even small changes in prompt conditioning influence perceived personality in LLMs (<a href="https://arxiv.org/abs/2402.01765" target="_blank" rel="noopener noreferrer">Sorokovikova et al., 2024</a>). This section gives you the dials to modulate that variability.</p>
            </div>
            <textarea id="chat-cog-style-input" rows="3" style="margin-bottom: 15px;"></textarea>

            <h3 class="section-title">Final Chat System Prompt (Generated)</h3>
            <pre id="chat-system-prompt" class="json-output" style="max-height: 200px; background-color: #e0e0e0; display: none;"></pre>
            
            <h3 class="section-title">Chat History</h3>
            <div id="chat-history" style="height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 15px; background-color: #f8f9fa;">
                <!-- Chat messages will appear here -->
            </div>

            <div class="flex-row">
                <input type="text" id="chat-input" placeholder="Send a message..." style="flex-grow: 1; margin-bottom: 0;">
                <button id="send-chat-button" class="action-button" style="width: auto;">Send</button>
            </div>
            <button id="clear-chat-button" class="action-button" style="width: auto; background-color: #6c757d; margin-top: 10px;">Clear Chat History</button>
            <div id="chat-status" class="status"></div>
          </div>
      </div>

      <!-- NEW: Module 5 - Psych Assessment -->
      <div id="assessment-module" class="module">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px;">
          <h2 style="margin: 0; display: flex; align-items: center; gap: 8px;">
            Module 5: Personality Alignment Assessment (TIPI 
            <button class="info-button" data-tooltip-target="tipi-tooltip">?</button>
          )</h2>
          <!-- Runs per Item Input -->
          <div>
            <label for="runs-per-item" style="font-size: 0.9em; margin-right: 5px;">Runs per Item:</label>
            <input type="number" id="runs-per-item" name="runs-per-item" value="3" min="1" max="10" style="width: 50px;">
          </div>
        </div>
        <div id="tipi-tooltip" class="info-tooltip-text" style="display: none;">
                 Uses the Ten-Item Personality Inventory (TIPI), a brief measure of the Big Five traits. See experimental-design.md for details.
            </div>
        <p class="module-description">Assess your own personality using the TIPI scale and compare it against the generated digital twin.</p>

        <!-- User Assessment Section -->
        <div id="user-assessment-section" style="margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #eee;">
            <h3 class="section-title">Your Personality Assessment (TIPI)</h3>
            <p style="font-size: 14px; color: #555; margin-bottom: 15px;">Rate how well the following pairs of traits describe you, even if one trait fits better than the other. Use the scale: 1 (Strongly Disagree) to 5 (Strongly Agree).</p>
            
            <!-- Button to start assessment -->
            <button type="button" id="start-user-assessment" class="action-button" style="margin-bottom: 15px;">Take Your Assessment</button>
            
            <form id="tipi-form">
                <!-- Container for TIPI questions - Hidden by default -->
                <div id="tipi-questions" style="margin-top: 15px; margin-bottom: 15px; display: none;">
                    <!-- Questions will be loaded here by JavaScript -->
                    <p>Loading assessment questions...</p> 
                </div>
                <!-- Submit button - Hidden by default -->
                <button type="submit" id="submit-user-assessment" class="action-button" style="margin-top: 15px; display: none;">Submit My Assessment</button>
                 <!-- Retake button - Hidden by default -->
                 <button type="button" id="retake-user-assessment" class="action-button" style="margin-top: 15px; background-color: #6c757d; display: none;">Retake Assessment</button>
            </form>
            <div id="user-assessment-status" class="status"></div>
        </div>

        <!-- AI Simulation & Results Section -->
        <div id="ai-comparison-section">
            <h3 class="section-title">AI Alignment Simulation</h3>
             <p style="font-size: 14px; color: #555; margin-bottom: 15px;">Run a simulation to have the AI answer the same questions based on its generated profile. Results will show alignment.</p>
            
            <div style="margin-bottom: 15px;">
                <label for="ai-assessment-temp" style="margin-right: 10px; font-weight: 500;">Simulation Temperature:</label>
                <input type="number" id="ai-assessment-temp" value="0.8" step="0.1" min="0" max="1.0" style="width: 80px; padding: 5px 8px; margin-bottom: 0;">
                 <span style="font-size: 12px; color: #666;">(Higher value = more creative/random responses)</span>
            </div>
            
            <button id="run-ai-assessment" class="action-button" disabled>Run AI Assessment & Compare</button>
            <div id="ai-assessment-status" class="status"></div>

            <div id="assessment-results-area" style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #ccc; display: none;">
              <h3>Alignment Results</h3>
              <p>Overall Alignment: <strong id="overall-alignment">--%</strong></p>
              <!-- New element for Item Agreement -->
              <p>Exact Item Agreement: <strong id="item-agreement">--%</strong></p> 
              <ul id="dimension-alignment-list" style="margin-bottom: 15px;"></ul>
              <div style="width: 100%; max-width: 400px; height: 300px; margin: 0 auto;">
                <canvas id="radar-chart"></canvas>
              </div>
            </div>
        </div>
      </div>

      <!-- Module 6: Reset (Renumbered) -->
       <div class="module">
        <div class="module-header">
          <div class="module-icon">♻️</div> 
          <h2 class="module-title">Reset</h2>
        </div>
        <p class="module-description">Reset the current session.</p>
        
        <button id="reset-session-button" class="action-button danger-button" style="width: 100%;">Reset Session</button>
      </div>

    </div>
  </div>

  <!-- Templates (Hidden by default) -->
  <template id="asset-group-template">
    <div class="asset-group" style="margin-bottom: 25px;">
        <h3 class="section-title profile-group-title" style="border-bottom: 1px solid #eee; padding-bottom: 5px; margin-bottom: 15px;">Profile ID: <span class="profile-id-display"></span></h3>
        <div class="flex-row">
            <div class="flex-col">
                <h4 style="margin-bottom: 10px;">Text Content</h4>
                <div class="content-grid text-content-grid">
                    <p>No text assets for this profile.</p>
                </div>
            </div>
            <div class="flex-col">
                <h4 style="margin-bottom: 10px;">Image Content</h4>
                <div class="content-grid image-content-grid">
                     <p>No image assets for this profile.</p>
                </div>
            </div>
        </div>
    </div>
  </template>

  <template id="asset-card-template">
      <div class="content-card">
          <div class="content-card-header">
              <span class="content-type"></span>
              <input type="checkbox" class="content-select" title="Select this asset">
          </div>
          <div class="content-title" title="Filename"></div>
          <div class="content-info source" title="Source URL/Upload"></div>
          <div class="content-info date"></div>
        <div class="content-preview"></div>
          <div style="margin-top: auto; padding-top: 10px;"> 
              <button class="action-button preview-button" style="width:100%; font-size: 12px; padding: 5px 8px;">Preview</button>
          </div>
      </div>
  </template>

  <!-- Modal for Previews -->
  <div id="preview-modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6);">
    <div style="background-color: #fff; margin: 10% auto; padding: 25px; border: 1px solid #888; width: 80%; max-width: 800px; border-radius: 8px; position: relative;">
      <span id="close-modal" style="position: absolute; top: 10px; right: 20px; color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
      <h3 id="modal-title" style="margin-bottom: 15px;">Asset Preview</h3>
      <div id="modal-content" style="max-height: 60vh; overflow-y: auto;">
        <!-- Preview content goes here -->
      </div>
    </div>
  </div>

  <!-- Include Chart.js library from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>

  <script src="/js/app.js"></script>
</body>
</html>